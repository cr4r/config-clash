import{r as S,b as c,j as t,i as p,s as B,h as N,c as ee,k as te,l as V,n as A,o as ne,d as U,q as re,g as G,t as ae,v as oe,w as C,x as le,y as se,z as ie,A as ce,D as de,u as ue,C as pe,E as x,F as he,B as y,G as fe,H as ve,J as ge}from"./index.c4329538.js";import{r as me}from"./logs.cc478f50.js";import{S as b}from"./Select.1ad757d6.js";import{R as ye}from"./rotate-cw.b40f6505.js";function be(e,l){if(e==null)return{};var o=we(e,l),a,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],!(l.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,a)||(o[a]=e[a]))}return o}function we(e,l){if(e==null)return{};var o={},a=Object.keys(e),n,r;for(r=0;r<a.length;r++)n=a[r],!(l.indexOf(n)>=0)&&(o[n]=e[n]);return o}var I=S.exports.forwardRef(function(e,l){var o=e.color,a=o===void 0?"currentColor":o,n=e.size,r=n===void 0?24:n,d=be(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...d,children:[t("polyline",{points:"8 17 12 21 16 17"}),t("line",{x1:"12",y1:"12",x2:"12",y2:"21"}),t("path",{d:"M20.88 18.09A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.29"})]})});I.propTypes={color:p.exports.string,size:p.exports.oneOfType([p.exports.string,p.exports.number])};I.displayName="DownloadCloud";const ke=I;function Ce(e,l){if(e==null)return{};var o=xe(e,l),a,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],!(l.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,a)||(o[a]=e[a]))}return o}function xe(e,l){if(e==null)return{};var o={},a=Object.keys(e),n,r;for(r=0;r<a.length;r++)n=a[r],!(l.indexOf(n)>=0)&&(o[n]=e[n]);return o}var P=S.exports.forwardRef(function(e,l){var o=e.color,a=o===void 0?"currentColor":o,n=e.size,r=n===void 0?24:n,d=Ce(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...d,children:[t("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),t("polyline",{points:"16 17 21 12 16 7"}),t("line",{x1:"21",y1:"12",x2:"9",y2:"12"})]})});P.propTypes={color:p.exports.string,size:p.exports.oneOfType([p.exports.string,p.exports.number])};P.displayName="LogOut";const _e=P;function Oe(e,l){if(e==null)return{};var o=Se(e,l),a,n;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],!(l.indexOf(a)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,a)||(o[a]=e[a]))}return o}function Se(e,l){if(e==null)return{};var o={},a=Object.keys(e),n,r;for(r=0;r<a.length;r++)n=a[r],!(l.indexOf(n)>=0)&&(o[n]=e[n]);return o}var j=S.exports.forwardRef(function(e,l){var o=e.color,a=o===void 0?"currentColor":o,n=e.size,r=n===void 0?24:n,d=Oe(e,["color","size"]);return c("svg",{ref:l,xmlns:"http://www.w3.org/2000/svg",width:r,height:r,viewBox:"0 0 24 24",fill:"none",stroke:a,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...d,children:[t("polyline",{points:"3 6 5 6 21 6"}),t("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),t("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),t("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})});j.propTypes={color:p.exports.string,size:p.exports.oneOfType([p.exports.string,p.exports.number])};j.displayName="Trash2";const Ne=j,{useState:Ie,useRef:Pe,useEffect:je,useCallback:Le}=N;function _(e){return t("input",{className:B.input,...e})}function ze({value:e,...l}){const[o,a]=Ie(e),n=Pe(e);je(()=>{n.current!==e&&a(e),n.current=e},[e]);const r=Le(d=>a(d.target.value),[a]);return t("input",{className:B.input,value:o,onChange:r,...l})}const $e="_root_1rtyh_1",Te="_section_1rtyh_2",Re="_wrapSwitch_1rtyh_28",De="_sep_1rtyh_34",Ee="_label_1rtyh_47",i={root:$e,section:Te,wrapSwitch:Re,sep:De,label:Ee},Fe="_fieldset_1ghjp_1",Me="_input_1ghjp_9",We="_cnt_1ghjp_9",O={fieldset:Fe,input:Me,cnt:We};function Ve({OptionComponent:e,optionPropsList:l,selectedIndex:o,onChange:a}){const n=ee("visually-hidden",O.input),r=d=>{a(d.target.value)};return t("fieldset",{className:O.fieldset,children:l.map((d,m)=>c("label",{children:[t("input",{type:"radio",checked:o===m,name:"selection",value:m,"aria-labelledby":"traffic chart type "+m,onChange:r,className:n}),t("div",{className:O.cnt,children:t(e,{...d})})]},m))})}const{useMemo:Ae}=N,Be={plugins:{legend:{display:!1}},scales:{x:{display:!1,type:"category"},y:{display:!1,type:"linear"}}},H=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],Ue=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ge=H;function He({id:e}){const l=te.read(),o=Ae(()=>({labels:Ge,datasets:[{...V,...A[e].up,data:H},{...V,...A[e].down,data:Ue}]}),[e]),a="chart-"+e;return ne(l.Chart,a,o,null,Be),t("div",{style:{width:100,padding:5},children:t("canvas",{id:a})})}const{useEffect:J,useState:Je,useCallback:v,useRef:qe}=N,Qe=[{id:0},{id:1},{id:2},{id:3}],Ke=[["debug","Debug"],["info","Info"],["warning","Warning"],["error","Error"],["silent","Silent"]],Xe=[{key:"port",label:"Http Port"},{key:"socks-port",label:"Socks5 Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"},{key:"mitm-port",label:"MITM Port"}],Ye=[["zh","\u4E2D\u6587"],["en","English"]],Ze=[["direct","Direct"],["rule","Rule"],["script","Script"],["global","Global"]],et=[["gvisor","gVisor"],["system","System"],["lwip","LWIP"]],tt=e=>({configs:re(e),apiConfig:G(e)}),nt=e=>({selectedChartStyleIndex:ve(e),latencyTestUrl:ge(e),apiConfig:G(e)}),rt=U(nt)(ot),dt=U(tt)(at);function at({dispatch:e,configs:l,apiConfig:o}){return J(()=>{e(ae(o))},[e,o]),t(rt,{configs:l})}function ot({dispatch:e,configs:l,selectedChartStyleIndex:o,latencyTestUrl:a,apiConfig:n}){var D,E,F,M;const[r,d]=Je(l),m=qe(l);J(()=>{m.current!==l&&d(l),m.current=l},[l]);const q=v(()=>{e(oe("apiConfig"))},[e]),w=v((s,u)=>{d({...r,[s]:u})},[r]),L=v((s,u)=>{const f={...r.tun,[s]:u};d({...r,tun:{...f}})},[r]),g=v(({name:s,value:u})=>{switch(s){case"mode":case"log-level":case"allow-lan":case"sniffing":w(s,u),e(C(n,{[s]:u})),s==="log-level"&&me({...n,logLevel:u});break;case"mitm-port":case"redir-port":case"socks-port":case"mixed-port":case"port":if(u!==""){const f=parseInt(u,10);if(f<0||f>65535)return}w(s,u);break;case"enable":case"stack":L(s,u),e(C(n,{tun:{[s]:u}}));break;default:return}},[n,e,w,L]),Q=v(s=>g(s.target),[g]),{selectChartStyleIndex:K,updateAppConfig:z}=le(),$=v(s=>{const u=s.target,{name:f,value:W}=u;switch(f){case"port":case"socks-port":case"mixed-port":case"redir-port":case"mitm-port":{const k=parseInt(W,10);if(k<0||k>65535)return;e(C(n,{[f]:k}));break}case"latencyTestUrl":{z(f,W);break}default:throw new Error(`unknown input name ${f}`)}},[n,e,z]),X=v(()=>{e(se(n))},[n,e]),Y=v(()=>{e(ie(n))},[n,e]),Z=v(()=>{e(ce(n))},[n,e]),{data:T}=de(["/version",n],()=>fe("/version",n)),{t:h,i18n:R}=ue();return c("div",{children:[t(pe,{title:h("Config")}),c("div",{className:i.root,children:[Xe.map(s=>r[s.key]!==void 0?c("div",{children:[t("div",{className:i.label,children:s.label}),t(_,{name:s.key,value:r[s.key],onChange:Q,onBlur:$})]},s.key):null),c("div",{children:[t("div",{className:i.label,children:"Mode"}),t(b,{options:Ze,selected:r.mode.toLowerCase(),onChange:s=>g({name:"mode",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Log Level"}),t(b,{options:Ke,selected:r["log-level"].toLowerCase(),onChange:s=>g({name:"log-level",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:h("allow_lan")}),t("div",{className:i.wrapSwitch,children:t(x,{name:"allow-lan",checked:r["allow-lan"],onChange:s=>g({name:"allow-lan",value:s})})})]}),T.meta&&c("div",{children:[t("div",{className:i.label,children:h("tls_sniffing")}),t("div",{className:i.wrapSwitch,children:t(x,{name:"sniffing",checked:r.sniffing,onChange:s=>g({name:"sniffing",value:s})})})]})]}),t("div",{className:i.sep,children:t("div",{})}),T.meta&&c(he,{children:[c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:h("enable_tun_device")}),t("div",{className:i.wrapSwitch,children:t(x,{checked:(D=r.tun)==null?void 0:D.enable,onChange:s=>g({name:"enable",value:s})})})]}),c("div",{children:[t("div",{className:i.label,children:"TUN IP Stack"}),t(b,{options:et,selected:(F=(E=r.tun)==null?void 0:E.stack)==null?void 0:F.toLowerCase(),onChange:s=>g({name:"stack",value:s.target.value})})]}),c("div",{children:[t("div",{className:i.label,children:"Device Name"}),t(_,{value:(M=r.tun)==null?void 0:M.device})]}),c("div",{children:[t("div",{className:i.label,children:"Interface Name"}),t(_,{value:r["interface-name"]})]})]}),t("div",{className:i.sep,children:t("div",{})}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:"Reload"}),t(y,{start:t(ye,{size:16}),label:h("reload_config_file"),onClick:X})]}),c("div",{children:[t("div",{className:i.label,children:"GEO Databases"}),t(y,{start:t(ke,{size:16}),label:h("update_geo_databases_file"),onClick:Y})]}),c("div",{children:[t("div",{className:i.label,children:"FakeIP"}),t(y,{start:t(Ne,{size:16}),label:h("flush_fake_ip_pool"),onClick:Z})]})]}),t("div",{className:i.sep,children:t("div",{})})]}),c("div",{className:i.section,children:[c("div",{children:[t("div",{className:i.label,children:h("latency_test_url")}),t(ze,{name:"latencyTestUrl",type:"text",value:a,onBlur:$})]}),c("div",{children:[t("div",{className:i.label,children:h("lang")}),t("div",{children:t(b,{options:Ye,selected:R.language,onChange:s=>R.changeLanguage(s.target.value)})})]}),c("div",{children:[t("div",{className:i.label,children:h("chart_style")}),t(Ve,{OptionComponent:He,optionPropsList:Qe,selectedIndex:o,onChange:K})]}),c("div",{children:[t("div",{className:i.label,children:"Action"}),t(y,{start:t(_e,{size:16}),label:"Switch backend",onClick:q})]})]})]})}export{dt as default};
